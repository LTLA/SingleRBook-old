<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Cross-annotating mouse brains | Assigning cell types with SingleR</title>
  <meta name="description" content="The SingleR book. Because sometimes, a vignette just isn’t enough." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Cross-annotating mouse brains | Assigning cell types with SingleR" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The SingleR book. Because sometimes, a vignette just isn’t enough." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Cross-annotating mouse brains | Assigning cell types with SingleR" />
  
  <meta name="twitter:description" content="The SingleR book. Because sometimes, a vignette just isn’t enough." />
  



<meta name="date" content="2020-07-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cross-annotating-human-pancreas.html"/>
<link rel="next" href="contributors.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The SingleR book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Basic usage</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#method-description"><i class="fa fa-check"></i><b>1.2</b> Method description</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#quick-start"><i class="fa fa-check"></i><b>1.3</b> Quick start</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#where-to-get-help"><i class="fa fa-check"></i><b>1.4</b> Where to get help</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html"><i class="fa fa-check"></i><b>2</b> Using the classic mode</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#annotation-the-test-dataset"><i class="fa fa-check"></i><b>2.2</b> Annotation the test dataset</a></li>
<li class="chapter" data-level="2.3" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#interaction-with-quality-control"><i class="fa fa-check"></i><b>2.3</b> Interaction with quality control</a></li>
<li class="chapter" data-level="2.4" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#choices-of-assay-data"><i class="fa fa-check"></i><b>2.4</b> Choices of assay data</a></li>
<li class="chapter" data-level="2.5" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#reference-choice"><i class="fa fa-check"></i><b>2.5</b> Comments on choice of references</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="more-markers.html"><a href="more-markers.html"><i class="fa fa-check"></i><b>3</b> Controlling marker detection</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="more-markers.html"><a href="more-markers.html#annotation-with-test-based-marker-detection"><i class="fa fa-check"></i><b>3.2</b> Annotation with test-based marker detection</a></li>
<li class="chapter" data-level="3.3" data-path="more-markers.html"><a href="more-markers.html#defining-custom-markers"><i class="fa fa-check"></i><b>3.3</b> Defining custom markers</a></li>
<li class="chapter" data-level="3.4" data-path="more-markers.html"><a href="more-markers.html#pseudo-bulk-aggregation"><i class="fa fa-check"></i><b>3.4</b> Pseudo-bulk aggregation</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="annotation-diagnostics.html"><a href="annotation-diagnostics.html"><i class="fa fa-check"></i><b>4</b> Annotation diagnostics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="annotation-diagnostics.html"><a href="annotation-diagnostics.html#based-on-the-scores-within-cells"><i class="fa fa-check"></i><b>4.2</b> Based on the scores within cells</a></li>
<li class="chapter" data-level="4.3" data-path="annotation-diagnostics.html"><a href="annotation-diagnostics.html#based-on-the-deltas-across-cells"><i class="fa fa-check"></i><b>4.3</b> Based on the deltas across cells</a></li>
<li class="chapter" data-level="4.4" data-path="annotation-diagnostics.html"><a href="annotation-diagnostics.html#based-on-marker-gene-expression"><i class="fa fa-check"></i><b>4.4</b> Based on marker gene expression</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="part"><span><b>II Advanced usage</b></span></li>
<li class="chapter" data-level="5" data-path="using-multiple-references.html"><a href="using-multiple-references.html"><i class="fa fa-check"></i><b>5</b> Using multiple references</a>
<ul>
<li class="chapter" data-level="5.1" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="using-multiple-references.html"><a href="using-multiple-references.html#using-reference-specific-labels"><i class="fa fa-check"></i><b>5.2</b> Using reference-specific labels</a></li>
<li class="chapter" data-level="5.3" data-path="using-multiple-references.html"><a href="using-multiple-references.html#comparing-scores-across-references"><i class="fa fa-check"></i><b>5.3</b> Comparing scores across references</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="using-multiple-references.html"><a href="using-multiple-references.html#combining-inferences-from-individual-references"><i class="fa fa-check"></i><b>5.3.1</b> Combining inferences from individual references</a></li>
<li class="chapter" data-level="5.3.2" data-path="using-multiple-references.html"><a href="using-multiple-references.html#combined-diagnostics"><i class="fa fa-check"></i><b>5.3.2</b> Combined diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="using-multiple-references.html"><a href="using-multiple-references.html#using-harmonized-labels"><i class="fa fa-check"></i><b>5.4</b> Using harmonized labels</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="using-multiple-references.html"><a href="using-multiple-references.html#sharing-information-during-marker-detection"><i class="fa fa-check"></i><b>5.4.1</b> Sharing information during marker detection</a></li>
<li class="chapter" data-level="5.4.2" data-path="using-multiple-references.html"><a href="using-multiple-references.html#manual-label-harmonization"><i class="fa fa-check"></i><b>5.4.2</b> Manual label harmonization</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-multiple-references.html"><a href="using-multiple-references.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploiting-the-cell-ontology.html"><a href="exploiting-the-cell-ontology.html"><i class="fa fa-check"></i><b>6</b> Exploiting the cell ontology</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction.html"><a href="introduction.html#motivation"><i class="fa fa-check"></i><b>6.1</b> Motivation</a></li>
<li class="chapter" data-level="6.2" data-path="exploiting-the-cell-ontology.html"><a href="exploiting-the-cell-ontology.html#basic-manipulation"><i class="fa fa-check"></i><b>6.2</b> Basic manipulation</a></li>
<li class="chapter" data-level="6.3" data-path="exploiting-the-cell-ontology.html"><a href="exploiting-the-cell-ontology.html#adjusting-resolution"><i class="fa fa-check"></i><b>6.3</b> Adjusting resolution</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-options.html"><a href="advanced-options.html"><i class="fa fa-check"></i><b>7</b> Advanced options</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-options.html"><a href="advanced-options.html#preconstructed-indices"><i class="fa fa-check"></i><b>7.1</b> Preconstructed indices</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-options.html"><a href="advanced-options.html#parallelization"><i class="fa fa-check"></i><b>7.2</b> Parallelization</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-options.html"><a href="advanced-options.html#approximate-algorithms"><i class="fa fa-check"></i><b>7.3</b> Approximate algorithms</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="part"><span><b>III Case studies</b></span></li>
<li class="chapter" data-level="8" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html"><i class="fa fa-check"></i><b>8</b> Cross-annotating human pancreas</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#loading-the-data"><i class="fa fa-check"></i><b>8.1</b> Loading the data</a></li>
<li class="chapter" data-level="8.2" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#applying-the-annotation"><i class="fa fa-check"></i><b>8.2</b> Applying the annotation</a></li>
<li class="chapter" data-level="8.3" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#diagnostics"><i class="fa fa-check"></i><b>8.3</b> Diagnostics</a></li>
<li class="chapter" data-level="8.4" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#comparison-to-clusters"><i class="fa fa-check"></i><b>8.4</b> Comparison to clusters</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cross-annotating-mouse-brains.html"><a href="cross-annotating-mouse-brains.html"><i class="fa fa-check"></i><b>9</b> Cross-annotating mouse brains</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#loading-the-data"><i class="fa fa-check"></i><b>9.1</b> Loading the data</a></li>
<li class="chapter" data-level="9.2" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#applying-the-annotation"><i class="fa fa-check"></i><b>9.2</b> Applying the annotation</a></li>
<li class="chapter" data-level="9.3" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#diagnostics"><i class="fa fa-check"></i><b>9.3</b> Diagnostics</a></li>
<li class="chapter" data-level="9.4" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#comparison-to-clusters"><i class="fa fa-check"></i><b>9.4</b> Comparison to clusters</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="10" data-path="contributors.html"><a href="contributors.html"><i class="fa fa-check"></i><b>10</b> Contributors</a>
<ul>
<li><a href="contributors.html#aaron-lun"><em>Aaron Lun</em></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i><b>11</b> Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://bioconductor.org" target="blank">Published by Bioconductor</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Assigning cell types with SingleR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cross-annotating-mouse-brains" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Cross-annotating mouse brains</h1>
<script>
document.addEventListener("click", function (event) {
    if (event.target.classList.contains("aaron-collapse")) {
        event.target.classList.toggle("active");
        var content = event.target.nextElementSibling;
        if (content.style.display === "block") {
            content.style.display = "none";
        } else {
            content.style.display = "block";
        }
    }
})
</script>
<style>
.aaron-collapse {
  background-color: #eee;
  color: #444;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 15px;
}

.aaron-content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
  background-color: #f1f1f1;
}
</style>
<div id="loading-the-data" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Loading the data</h2>
<p>We load the classic <span class="citation">Zeisel et al. (<a href="#ref-zeisel2015brain" role="doc-biblioref">2015</a>)</span> dataset as our reference.
Here, we’ll rely on the fact that the authors have already performed quality control.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="cross-annotating-mouse-brains.html#cb146-1" aria-hidden="true"></a><span class="kw">library</span>(scRNAseq)</span>
<span id="cb146-2"><a href="cross-annotating-mouse-brains.html#cb146-2" aria-hidden="true"></a>sceZ &lt;-<span class="st"> </span><span class="kw">ZeiselBrainData</span>()</span></code></pre></div>
<p>We compute log-expression values for use in marker detection inside <code>SingleR()</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="cross-annotating-mouse-brains.html#cb147-1" aria-hidden="true"></a><span class="kw">library</span>(scater)</span>
<span id="cb147-2"><a href="cross-annotating-mouse-brains.html#cb147-2" aria-hidden="true"></a>sceZ &lt;-<span class="st"> </span><span class="kw">logNormCounts</span>(sceZ)</span></code></pre></div>
<p>We examine the distribution of labels in this reference.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="cross-annotating-mouse-brains.html#cb148-1" aria-hidden="true"></a><span class="kw">table</span>(sceZ<span class="op">$</span>level2class)</span></code></pre></div>
<pre><code>## 
##    (none)    Astro1    Astro2   CA1Pyr1   CA1Pyr2 CA1PyrInt   CA2Pyr2   Choroid 
##       189        68        61       380       447        49        41        10 
##   ClauPyr     Epend      Int1     Int10     Int11     Int12     Int13     Int14 
##         5        20        12        21        10        21        15        22 
##     Int15     Int16      Int2      Int3      Int4      Int5      Int6      Int7 
##        18        20        24        10        15        20        22        23 
##      Int8      Int9      Mgl1      Mgl2    Oligo1    Oligo2    Oligo3    Oligo4 
##        26        11        17        16        45        98        87       106 
##    Oligo5    Oligo6     Peric      Pvm1      Pvm2   S1PyrDL  S1PyrL23   S1PyrL4 
##       125       359        21        32        33        81        74        26 
##   S1PyrL5  S1PyrL5a   S1PyrL6  S1PyrL6b    SubPyr     Vend1     Vend2      Vsmc 
##        16        28        39        21        22        32       105        62</code></pre>
<p>We load the <span class="citation">Tasic et al. (<a href="#ref-tasic2016adult" role="doc-biblioref">2016</a>)</span> dataset as our test.
While not strictly necessary, we remove putative low-quality cells to simplify later interpretation.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="cross-annotating-mouse-brains.html#cb150-1" aria-hidden="true"></a>sceT &lt;-<span class="st"> </span><span class="kw">TasicBrainData</span>()</span>
<span id="cb150-2"><a href="cross-annotating-mouse-brains.html#cb150-2" aria-hidden="true"></a>sceT &lt;-<span class="st"> </span><span class="kw">addPerCellQC</span>(sceT, <span class="dt">subsets=</span><span class="kw">list</span>(<span class="dt">mito=</span><span class="kw">grep</span>(<span class="st">&quot;^mt_&quot;</span>, <span class="kw">rownames</span>(sceT))))</span>
<span id="cb150-3"><a href="cross-annotating-mouse-brains.html#cb150-3" aria-hidden="true"></a>qc &lt;-<span class="st"> </span><span class="kw">quickPerCellQC</span>(<span class="kw">colData</span>(sceT), </span>
<span id="cb150-4"><a href="cross-annotating-mouse-brains.html#cb150-4" aria-hidden="true"></a>    <span class="dt">percent_subsets=</span><span class="kw">c</span>(<span class="st">&quot;subsets_mito_percent&quot;</span>, <span class="st">&quot;altexps_ERCC_percent&quot;</span>))</span>
<span id="cb150-5"><a href="cross-annotating-mouse-brains.html#cb150-5" aria-hidden="true"></a>sceT &lt;-<span class="st"> </span>sceT[,<span class="kw">which</span>(<span class="op">!</span>qc<span class="op">$</span>discard)]</span></code></pre></div>
<p>The Tasic dataset was generated using read-based technologies so we need to adjust for the transcript length.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="cross-annotating-mouse-brains.html#cb151-1" aria-hidden="true"></a><span class="kw">library</span>(AnnotationHub)</span>
<span id="cb151-2"><a href="cross-annotating-mouse-brains.html#cb151-2" aria-hidden="true"></a>mm.db &lt;-<span class="st"> </span><span class="kw">AnnotationHub</span>()[[<span class="st">&quot;AH73905&quot;</span>]]</span>
<span id="cb151-3"><a href="cross-annotating-mouse-brains.html#cb151-3" aria-hidden="true"></a>mm.exons &lt;-<span class="st"> </span><span class="kw">exonsBy</span>(mm.db, <span class="dt">by=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb151-4"><a href="cross-annotating-mouse-brains.html#cb151-4" aria-hidden="true"></a>mm.exons &lt;-<span class="st"> </span><span class="kw">reduce</span>(mm.exons)</span>
<span id="cb151-5"><a href="cross-annotating-mouse-brains.html#cb151-5" aria-hidden="true"></a>mm.len &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">width</span>(mm.exons))</span>
<span id="cb151-6"><a href="cross-annotating-mouse-brains.html#cb151-6" aria-hidden="true"></a>mm.symb &lt;-<span class="st"> </span><span class="kw">mapIds</span>(mm.db, <span class="dt">keys=</span><span class="kw">names</span>(mm.len), <span class="dt">keytype=</span><span class="st">&quot;GENEID&quot;</span>, <span class="dt">column=</span><span class="st">&quot;SYMBOL&quot;</span>)</span>
<span id="cb151-7"><a href="cross-annotating-mouse-brains.html#cb151-7" aria-hidden="true"></a><span class="kw">names</span>(mm.len) &lt;-<span class="st"> </span>mm.symb</span>
<span id="cb151-8"><a href="cross-annotating-mouse-brains.html#cb151-8" aria-hidden="true"></a></span>
<span id="cb151-9"><a href="cross-annotating-mouse-brains.html#cb151-9" aria-hidden="true"></a><span class="kw">library</span>(scater)</span>
<span id="cb151-10"><a href="cross-annotating-mouse-brains.html#cb151-10" aria-hidden="true"></a>keep &lt;-<span class="st"> </span><span class="kw">intersect</span>(<span class="kw">names</span>(mm.len), <span class="kw">rownames</span>(sceT))</span>
<span id="cb151-11"><a href="cross-annotating-mouse-brains.html#cb151-11" aria-hidden="true"></a>sceT &lt;-<span class="st"> </span>sceT[keep,]</span>
<span id="cb151-12"><a href="cross-annotating-mouse-brains.html#cb151-12" aria-hidden="true"></a><span class="kw">assay</span>(sceT, <span class="st">&quot;TPM&quot;</span>) &lt;-<span class="st"> </span><span class="kw">calculateTPM</span>(sceT, <span class="dt">lengths=</span>mm.len[keep])</span></code></pre></div>
</div>
<div id="applying-the-annotation" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Applying the annotation</h2>
<p>We apply <code>SingleR()</code> with Wilcoxon rank sum test-based marker detection to annotate the Tasic dataset with the Zeisel labels.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="cross-annotating-mouse-brains.html#cb152-1" aria-hidden="true"></a><span class="kw">library</span>(SingleR)</span>
<span id="cb152-2"><a href="cross-annotating-mouse-brains.html#cb152-2" aria-hidden="true"></a>pred.tasic &lt;-<span class="st"> </span><span class="kw">SingleR</span>(<span class="dt">test=</span>sceT, <span class="dt">ref=</span>sceZ, <span class="dt">labels=</span>sceZ<span class="op">$</span>level2class, </span>
<span id="cb152-3"><a href="cross-annotating-mouse-brains.html#cb152-3" aria-hidden="true"></a>    <span class="dt">assay.type.test=</span><span class="st">&quot;TPM&quot;</span>, <span class="dt">de.method=</span><span class="st">&quot;wilcox&quot;</span>)</span></code></pre></div>
<p>We examine the distribution of predicted labels:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="cross-annotating-mouse-brains.html#cb153-1" aria-hidden="true"></a><span class="kw">table</span>(pred.tasic<span class="op">$</span>labels)</span></code></pre></div>
<pre><code>## 
##   Astro1   Astro2  CA1Pyr2  CA2Pyr2  ClauPyr     Int1    Int10    Int11 
##        1        5        1        3        1      152       98        2 
##    Int12    Int13    Int14    Int15    Int16     Int2     Int3     Int4 
##        9       18       24       16       10      146       94       29 
##     Int6     Int7     Int8     Int9   Oligo1   Oligo2   Oligo3   Oligo4 
##       14        2       35       31        8        1        7        1 
##   Oligo6    Peric  S1PyrDL S1PyrL23  S1PyrL4  S1PyrL5 S1PyrL5a  S1PyrL6 
##        1        1      319       73       16        4      201       46 
## S1PyrL6b   SubPyr 
##       73        5</code></pre>
<p>We can also examine the number of discarded cells for each label:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="cross-annotating-mouse-brains.html#cb155-1" aria-hidden="true"></a><span class="kw">table</span>(<span class="dt">Label=</span>pred.tasic<span class="op">$</span>labels,</span>
<span id="cb155-2"><a href="cross-annotating-mouse-brains.html#cb155-2" aria-hidden="true"></a>    <span class="dt">Lost=</span><span class="kw">is.na</span>(pred.tasic<span class="op">$</span>pruned.labels))</span></code></pre></div>
<pre><code>##           Lost
## Label      FALSE TRUE
##   Astro1       1    0
##   Astro2       5    0
##   CA1Pyr2      1    0
##   CA2Pyr2      3    0
##   ClauPyr      1    0
##   Int1       152    0
##   Int10       98    0
##   Int11        2    0
##   Int12        9    0
##   Int13       18    0
##   Int14       23    1
##   Int15       16    0
##   Int16       10    0
##   Int2       144    2
##   Int3        94    0
##   Int4        29    0
##   Int6        14    0
##   Int7         2    0
##   Int8        35    0
##   Int9        31    0
##   Oligo1       8    0
##   Oligo2       1    0
##   Oligo3       7    0
##   Oligo4       1    0
##   Oligo6       1    0
##   Peric        1    0
##   S1PyrDL    303   16
##   S1PyrL23    73    0
##   S1PyrL4     16    0
##   S1PyrL5      4    0
##   S1PyrL5a   200    1
##   S1PyrL6     45    1
##   S1PyrL6b    72    1
##   SubPyr       5    0</code></pre>
</div>
<div id="diagnostics" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Diagnostics</h2>
<p>We visualize the assignment scores for each label in Figure <a href="cross-annotating-mouse-brains.html#fig:unref-brain-score-heatmap">9.1</a>.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="cross-annotating-mouse-brains.html#cb157-1" aria-hidden="true"></a><span class="kw">plotScoreHeatmap</span>(pred.tasic)</span></code></pre></div>
<div class="figure"><span id="fig:unref-brain-score-heatmap"></span>
<img src="brain_files/figure-html/unref-brain-score-heatmap-1.png" alt="Heatmap of the (normalized) assignment scores for each cell (column) in the Tasic test dataset with respect to each label (row) in the Zeisel reference dataset. The final assignment for each cell is shown in the annotation bar at the top." width="960" />
<p class="caption">
Figure 9.1: Heatmap of the (normalized) assignment scores for each cell (column) in the Tasic test dataset with respect to each label (row) in the Zeisel reference dataset. The final assignment for each cell is shown in the annotation bar at the top.
</p>
</div>
<p>The delta for each cell is visualized in Figure <a href="cross-annotating-mouse-brains.html#fig:unref-brain-delta-dist">9.2</a>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="cross-annotating-mouse-brains.html#cb158-1" aria-hidden="true"></a><span class="kw">plotDeltaDistribution</span>(pred.tasic)</span></code></pre></div>
<div class="figure"><span id="fig:unref-brain-delta-dist"></span>
<img src="brain_files/figure-html/unref-brain-delta-dist-1.png" alt="Distributions of the deltas for each cell in the Tasic dataset assigned to each label in the Zeisel dataset. Each cell is represented by a point; low-quality assignments that were pruned out are colored in orange." width="960" />
<p class="caption">
Figure 9.2: Distributions of the deltas for each cell in the Tasic dataset assigned to each label in the Zeisel dataset. Each cell is represented by a point; low-quality assignments that were pruned out are colored in orange.
</p>
</div>
<p>Finally, we visualize the heatmaps of the marker genes for the most frequent label in Figure <a href="cross-annotating-mouse-brains.html#fig:unref-brain-marker-heat">9.3</a>.
We could show these for all labels but I wouldn’t want to bore you with a parade of large heatmaps.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="cross-annotating-mouse-brains.html#cb159-1" aria-hidden="true"></a><span class="kw">library</span>(scater)</span>
<span id="cb159-2"><a href="cross-annotating-mouse-brains.html#cb159-2" aria-hidden="true"></a>collected &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb159-3"><a href="cross-annotating-mouse-brains.html#cb159-3" aria-hidden="true"></a>all.markers &lt;-<span class="st"> </span><span class="kw">metadata</span>(pred.tasic)<span class="op">$</span>de.genes</span>
<span id="cb159-4"><a href="cross-annotating-mouse-brains.html#cb159-4" aria-hidden="true"></a></span>
<span id="cb159-5"><a href="cross-annotating-mouse-brains.html#cb159-5" aria-hidden="true"></a>sceT &lt;-<span class="st"> </span><span class="kw">logNormCounts</span>(sceT)</span>
<span id="cb159-6"><a href="cross-annotating-mouse-brains.html#cb159-6" aria-hidden="true"></a>top.label &lt;-<span class="st"> </span><span class="kw">names</span>(<span class="kw">sort</span>(<span class="kw">table</span>(pred.tasic<span class="op">$</span>labels), <span class="dt">decreasing=</span><span class="ot">TRUE</span>))[<span class="dv">1</span>]</span>
<span id="cb159-7"><a href="cross-annotating-mouse-brains.html#cb159-7" aria-hidden="true"></a></span>
<span id="cb159-8"><a href="cross-annotating-mouse-brains.html#cb159-8" aria-hidden="true"></a>per.label &lt;-<span class="st"> </span><span class="kw">sumCountsAcrossCells</span>(<span class="kw">logcounts</span>(sceT), </span>
<span id="cb159-9"><a href="cross-annotating-mouse-brains.html#cb159-9" aria-hidden="true"></a>    <span class="dt">ids=</span>pred.tasic<span class="op">$</span>labels, <span class="dt">average=</span><span class="ot">TRUE</span>)</span>
<span id="cb159-10"><a href="cross-annotating-mouse-brains.html#cb159-10" aria-hidden="true"></a>per.label &lt;-<span class="st"> </span><span class="kw">assay</span>(per.label)[<span class="kw">unique</span>(<span class="kw">unlist</span>(all.markers[[top.label]])),]</span>
<span id="cb159-11"><a href="cross-annotating-mouse-brains.html#cb159-11" aria-hidden="true"></a>pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(per.label, <span class="dt">main=</span>top.label)</span></code></pre></div>
<div class="figure"><span id="fig:unref-brain-marker-heat"></span>
<img src="brain_files/figure-html/unref-brain-marker-heat-1.png" alt="Heatmap of log-expression values in the Tasic dataset for all marker genes upregulated in the most frequent label from the Zeisel reference dataset." width="960" />
<p class="caption">
Figure 9.3: Heatmap of log-expression values in the Tasic dataset for all marker genes upregulated in the most frequent label from the Zeisel reference dataset.
</p>
</div>
</div>
<div id="comparison-to-clusters" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Comparison to clusters</h2>
<p>For comparison, we will perform a quick unsupervised analysis of the Grun dataset.
We model the variances using the spike-in data and we perform graph-based clustering.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="cross-annotating-mouse-brains.html#cb160-1" aria-hidden="true"></a><span class="kw">library</span>(scran)</span>
<span id="cb160-2"><a href="cross-annotating-mouse-brains.html#cb160-2" aria-hidden="true"></a>decT &lt;-<span class="st"> </span><span class="kw">modelGeneVarWithSpikes</span>(sceT, <span class="st">&quot;ERCC&quot;</span>)</span>
<span id="cb160-3"><a href="cross-annotating-mouse-brains.html#cb160-3" aria-hidden="true"></a></span>
<span id="cb160-4"><a href="cross-annotating-mouse-brains.html#cb160-4" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1000100</span>)</span>
<span id="cb160-5"><a href="cross-annotating-mouse-brains.html#cb160-5" aria-hidden="true"></a>sceT &lt;-<span class="st"> </span><span class="kw">denoisePCA</span>(sceT, decT, <span class="dt">subset.row=</span><span class="kw">getTopHVGs</span>(decT, <span class="dt">n=</span><span class="dv">2500</span>))</span>
<span id="cb160-6"><a href="cross-annotating-mouse-brains.html#cb160-6" aria-hidden="true"></a>sceT<span class="op">$</span>cluster &lt;-<span class="st"> </span><span class="kw">clusterSNNGraph</span>(sceT, <span class="dt">use.dimred=</span><span class="st">&quot;PCA&quot;</span>)</span></code></pre></div>
<p>We do not observe a clean 1:1 mapping between clusters and labels in Figure <a href="cross-annotating-mouse-brains.html#fig:unref-brain-label-clusters">9.4</a>,
probably because many of the labels represent closely related cell types that are difficult to distinguish.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="cross-annotating-mouse-brains.html#cb161-1" aria-hidden="true"></a>tab &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="dt">cluster=</span>sceT<span class="op">$</span>cluster, <span class="dt">label=</span>pred.tasic<span class="op">$</span>labels) </span>
<span id="cb161-2"><a href="cross-annotating-mouse-brains.html#cb161-2" aria-hidden="true"></a>pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(<span class="kw">log10</span>(tab<span class="op">+</span><span class="dv">10</span>))</span></code></pre></div>
<div class="figure"><span id="fig:unref-brain-label-clusters"></span>
<img src="brain_files/figure-html/unref-brain-label-clusters-1.png" alt="Heatmap of the log-transformed number of cells in each combination of label (column) and cluster (row) in the Tasic dataset." width="672" />
<p class="caption">
Figure 9.4: Heatmap of the log-transformed number of cells in each combination of label (column) and cluster (row) in the Tasic dataset.
</p>
</div>
<p>We proceed to the most important part of the analysis.
Yes, that’s right, the <span class="math inline">\(t\)</span>-SNE plot (Figure <a href="cross-annotating-mouse-brains.html#fig:unref-brain-label-tsne">9.5</a>).</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="cross-annotating-mouse-brains.html#cb162-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">101010100</span>)</span>
<span id="cb162-2"><a href="cross-annotating-mouse-brains.html#cb162-2" aria-hidden="true"></a>sceT &lt;-<span class="st"> </span><span class="kw">runTSNE</span>(sceT, <span class="dt">dimred=</span><span class="st">&quot;PCA&quot;</span>)</span>
<span id="cb162-3"><a href="cross-annotating-mouse-brains.html#cb162-3" aria-hidden="true"></a><span class="kw">plotTSNE</span>(sceT, <span class="dt">colour_by=</span><span class="st">&quot;cluster&quot;</span>, <span class="dt">text_colour=</span><span class="st">&quot;red&quot;</span>,</span>
<span id="cb162-4"><a href="cross-annotating-mouse-brains.html#cb162-4" aria-hidden="true"></a>    <span class="dt">text_by=</span><span class="kw">I</span>(pred.tasic<span class="op">$</span>labels))</span></code></pre></div>
<div class="figure"><span id="fig:unref-brain-label-tsne"></span>
<img src="brain_files/figure-html/unref-brain-label-tsne-1.png" alt="$t$-SNE plot of the Tasic dataset, where each point is a cell and is colored by the assigned cluster. Reference labels from the Zeisel dataset are also placed on the median coordinate across all cells assigned with that label." width="672" />
<p class="caption">
Figure 9.5: <span class="math inline">\(t\)</span>-SNE plot of the Tasic dataset, where each point is a cell and is colored by the assigned cluster. Reference labels from the Zeisel dataset are also placed on the median coordinate across all cells assigned with that label.
</p>
</div>
</div>
<div id="session-information" class="section level2 unnumbered">
<h2>Session information</h2>
<button class="aaron-collapse">
View session info
</button>
<div class="aaron-content">
<pre><code>R version 4.0.0 Patched (2020-05-01 r78341)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.4 LTS

Matrix products: default
BLAS:   /home/luna/Software/R/R-4-0-branch-dev/lib/libRblas.so
LAPACK: /home/luna/Software/R/R-4-0-branch-dev/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] scran_1.17.4                SingleR_1.3.6              
 [3] ensembldb_2.13.1            AnnotationFilter_1.13.0    
 [5] GenomicFeatures_1.41.0      AnnotationDbi_1.51.1       
 [7] AnnotationHub_2.21.1        BiocFileCache_1.13.0       
 [9] dbplyr_1.4.4                scater_1.17.3              
[11] ggplot2_3.3.2               scRNAseq_2.3.6             
[13] SingleCellExperiment_1.11.6 SummarizedExperiment_1.19.5
[15] DelayedArray_0.15.6         matrixStats_0.56.0         
[17] Matrix_1.2-18               Biobase_2.49.0             
[19] GenomicRanges_1.41.5        GenomeInfoDb_1.25.5        
[21] IRanges_2.23.10             S4Vectors_0.27.12          
[23] BiocGenerics_0.35.4         BiocStyle_2.17.0           
[25] rebook_0.99.0              

loaded via a namespace (and not attached):
  [1] Rtsne_0.15                    ggbeeswarm_0.6.0             
  [3] colorspace_1.4-1              ellipsis_0.3.1               
  [5] scuttle_0.99.10               XVector_0.29.3               
  [7] BiocNeighbors_1.7.0           farver_2.0.3                 
  [9] bit64_0.9-7                   interactiveDisplayBase_1.27.5
 [11] codetools_0.2-16              knitr_1.29                   
 [13] Rsamtools_2.5.3               pheatmap_1.0.12              
 [15] graph_1.67.1                  shiny_1.5.0                  
 [17] BiocManager_1.30.10           compiler_4.0.0               
 [19] httr_1.4.1                    dqrng_0.2.1                  
 [21] assertthat_0.2.1              fastmap_1.0.1                
 [23] lazyeval_0.2.2                limma_3.45.7                 
 [25] later_1.1.0.1                 BiocSingular_1.5.0           
 [27] htmltools_0.5.0               prettyunits_1.1.1            
 [29] tools_4.0.0                   igraph_1.2.5                 
 [31] rsvd_1.0.3                    gtable_0.3.0                 
 [33] glue_1.4.1                    GenomeInfoDbData_1.2.3       
 [35] dplyr_1.0.0                   rappdirs_0.3.1               
 [37] Rcpp_1.0.4.6                  vctrs_0.3.1                  
 [39] Biostrings_2.57.2             ExperimentHub_1.15.0         
 [41] rtracklayer_1.49.3            DelayedMatrixStats_1.11.1    
 [43] xfun_0.15                     stringr_1.4.0                
 [45] ps_1.3.3                      mime_0.9                     
 [47] lifecycle_0.2.0               irlba_2.3.3                  
 [49] statmod_1.4.34                XML_3.99-0.3                 
 [51] edgeR_3.31.4                  zlibbioc_1.35.0              
 [53] scales_1.1.1                  hms_0.5.3                    
 [55] promises_1.1.1                ProtGenerics_1.21.0          
 [57] RColorBrewer_1.1-2            yaml_2.2.1                   
 [59] curl_4.3                      memoise_1.1.0                
 [61] gridExtra_2.3                 biomaRt_2.45.1               
 [63] stringi_1.4.6                 RSQLite_2.2.0                
 [65] highr_0.8                     BiocVersion_3.12.0           
 [67] BiocParallel_1.23.0           rlang_0.4.6                  
 [69] pkgconfig_2.0.3               bitops_1.0-6                 
 [71] evaluate_0.14                 lattice_0.20-41              
 [73] purrr_0.3.4                   labeling_0.3                 
 [75] GenomicAlignments_1.25.3      CodeDepends_0.6.5            
 [77] cowplot_1.0.0                 bit_1.1-15.2                 
 [79] processx_3.4.2                tidyselect_1.1.0             
 [81] magrittr_1.5                  bookdown_0.20                
 [83] R6_2.4.1                      generics_0.0.2               
 [85] DBI_1.1.0                     pillar_1.4.4                 
 [87] withr_2.2.0                   RCurl_1.98-1.2               
 [89] tibble_3.0.1                  crayon_1.3.4                 
 [91] rmarkdown_2.3                 viridis_0.5.1                
 [93] progress_1.2.2                locfit_1.5-9.4               
 [95] grid_4.0.0                    blob_1.2.1                   
 [97] callr_3.4.3                   digest_0.6.25                
 [99] xtable_1.8-4                  httpuv_1.5.4                 
[101] openssl_1.4.2                 munsell_0.5.0                
[103] beeswarm_0.2.3                viridisLite_0.3.0            
[105] vipor_0.4.5                   askpass_1.1                  </code></pre>
</div>

</div>
</div>



<h3> Bibliography</h3>
<div id="refs" class="references">
<div id="ref-tasic2016adult">
<p>Tasic, B., V. Menon, T. N. Nguyen, T. K. Kim, T. Jarsky, Z. Yao, B. Levi, et al. 2016. “Adult mouse cortical cell taxonomy revealed by single cell transcriptomics.” <em>Nat. Neurosci.</em> 19 (2): 335–46.</p>
</div>
<div id="ref-zeisel2015brain">
<p>Zeisel, A., A. B. Munoz-Manchado, S. Codeluppi, P. Lonnerberg, G. La Manno, A. Jureus, S. Marques, et al. 2015. “Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq.” <em>Science</em> 347 (6226): 1138–42.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cross-annotating-human-pancreas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="contributors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/LTLA/SingleRBook-base/edit/master/brain.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/LTLA/SingleRBook-base/commits/master/brain.Rmd",
"text": null
},
"view": {
"link": "https://github.com/LTLA/SingleRBook-base/blob/master/brain.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"bookdown::epub_book": "default",
"cover-image": "https://www.bioconductor.org/images/logo_bioconductor.gif",
"favicon": "https://bioc2019.bioconductor.org/images/favicon.ico"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
