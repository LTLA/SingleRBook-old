<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Controlling marker detection | Assigning cell types with SingleR</title>
  <meta name="description" content="Chapter 3 Controlling marker detection | Assigning cell types with SingleR" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Controlling marker detection | Assigning cell types with SingleR" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Controlling marker detection | Assigning cell types with SingleR" />
  
  
  



<meta name="date" content="2020-07-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using-the-classic-mode.html"/>
<link rel="next" href="annotation-diagnostics.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The SingleR book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Basic usage</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#method-description"><i class="fa fa-check"></i><b>1.2</b> Method description</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#quick-start"><i class="fa fa-check"></i><b>1.3</b> Quick start</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#where-to-get-help"><i class="fa fa-check"></i><b>1.4</b> Where to get help</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html"><i class="fa fa-check"></i><b>2</b> Using the classic mode</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#annotating-the-test-dataset"><i class="fa fa-check"></i><b>2.2</b> Annotating the test dataset</a></li>
<li class="chapter" data-level="2.3" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#interaction-with-quality-control"><i class="fa fa-check"></i><b>2.3</b> Interaction with quality control</a></li>
<li class="chapter" data-level="2.4" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#choices-of-assay-data"><i class="fa fa-check"></i><b>2.4</b> Choices of assay data</a></li>
<li class="chapter" data-level="2.5" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#reference-choice"><i class="fa fa-check"></i><b>2.5</b> Comments on choice of references</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="more-markers.html"><a href="more-markers.html"><i class="fa fa-check"></i><b>3</b> Controlling marker detection</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="more-markers.html"><a href="more-markers.html#annotation-with-test-based-marker-detection"><i class="fa fa-check"></i><b>3.2</b> Annotation with test-based marker detection</a></li>
<li class="chapter" data-level="3.3" data-path="more-markers.html"><a href="more-markers.html#defining-custom-markers"><i class="fa fa-check"></i><b>3.3</b> Defining custom markers</a></li>
<li class="chapter" data-level="3.4" data-path="more-markers.html"><a href="more-markers.html#pseudo-bulk-aggregation"><i class="fa fa-check"></i><b>3.4</b> Pseudo-bulk aggregation</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="annotation-diagnostics.html"><a href="annotation-diagnostics.html"><i class="fa fa-check"></i><b>4</b> Annotation diagnostics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="annotation-diagnostics.html"><a href="annotation-diagnostics.html#based-on-the-scores-within-cells"><i class="fa fa-check"></i><b>4.2</b> Based on the scores within cells</a></li>
<li class="chapter" data-level="4.3" data-path="annotation-diagnostics.html"><a href="annotation-diagnostics.html#based-on-the-deltas-across-cells"><i class="fa fa-check"></i><b>4.3</b> Based on the deltas across cells</a></li>
<li class="chapter" data-level="4.4" data-path="annotation-diagnostics.html"><a href="annotation-diagnostics.html#based-on-marker-gene-expression"><i class="fa fa-check"></i><b>4.4</b> Based on marker gene expression</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="part"><span><b>II Advanced usage</b></span></li>
<li class="chapter" data-level="5" data-path="using-multiple-references.html"><a href="using-multiple-references.html"><i class="fa fa-check"></i><b>5</b> Using multiple references</a>
<ul>
<li class="chapter" data-level="5.1" data-path="using-the-classic-mode.html"><a href="using-the-classic-mode.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="using-multiple-references.html"><a href="using-multiple-references.html#using-reference-specific-labels"><i class="fa fa-check"></i><b>5.2</b> Using reference-specific labels</a></li>
<li class="chapter" data-level="5.3" data-path="using-multiple-references.html"><a href="using-multiple-references.html#comparing-scores-across-references"><i class="fa fa-check"></i><b>5.3</b> Comparing scores across references</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="using-multiple-references.html"><a href="using-multiple-references.html#combining-inferences-from-individual-references"><i class="fa fa-check"></i><b>5.3.1</b> Combining inferences from individual references</a></li>
<li class="chapter" data-level="5.3.2" data-path="using-multiple-references.html"><a href="using-multiple-references.html#combined-diagnostics"><i class="fa fa-check"></i><b>5.3.2</b> Combined diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="using-multiple-references.html"><a href="using-multiple-references.html#using-harmonized-labels"><i class="fa fa-check"></i><b>5.4</b> Using harmonized labels</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="using-multiple-references.html"><a href="using-multiple-references.html#sharing-information-during-marker-detection"><i class="fa fa-check"></i><b>5.4.1</b> Sharing information during marker detection</a></li>
<li class="chapter" data-level="5.4.2" data-path="using-multiple-references.html"><a href="using-multiple-references.html#manual-label-harmonization"><i class="fa fa-check"></i><b>5.4.2</b> Manual label harmonization</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-multiple-references.html"><a href="using-multiple-references.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploiting-the-cell-ontology.html"><a href="exploiting-the-cell-ontology.html"><i class="fa fa-check"></i><b>6</b> Exploiting the cell ontology</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction.html"><a href="introduction.html#motivation"><i class="fa fa-check"></i><b>6.1</b> Motivation</a></li>
<li class="chapter" data-level="6.2" data-path="exploiting-the-cell-ontology.html"><a href="exploiting-the-cell-ontology.html#basic-manipulation"><i class="fa fa-check"></i><b>6.2</b> Basic manipulation</a></li>
<li class="chapter" data-level="6.3" data-path="exploiting-the-cell-ontology.html"><a href="exploiting-the-cell-ontology.html#adjusting-resolution"><i class="fa fa-check"></i><b>6.3</b> Adjusting resolution</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-options.html"><a href="advanced-options.html"><i class="fa fa-check"></i><b>7</b> Advanced options</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-options.html"><a href="advanced-options.html#preconstructed-indices"><i class="fa fa-check"></i><b>7.1</b> Preconstructed indices</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-options.html"><a href="advanced-options.html#parallelization"><i class="fa fa-check"></i><b>7.2</b> Parallelization</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-options.html"><a href="advanced-options.html#approximate-algorithms"><i class="fa fa-check"></i><b>7.3</b> Approximate algorithms</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="part"><span><b>III Case studies</b></span></li>
<li class="chapter" data-level="8" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html"><i class="fa fa-check"></i><b>8</b> Cross-annotating human pancreas</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#loading-the-data"><i class="fa fa-check"></i><b>8.1</b> Loading the data</a></li>
<li class="chapter" data-level="8.2" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#applying-the-annotation"><i class="fa fa-check"></i><b>8.2</b> Applying the annotation</a></li>
<li class="chapter" data-level="8.3" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#diagnostics"><i class="fa fa-check"></i><b>8.3</b> Diagnostics</a></li>
<li class="chapter" data-level="8.4" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#comparison-to-clusters"><i class="fa fa-check"></i><b>8.4</b> Comparison to clusters</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cross-annotating-mouse-brains.html"><a href="cross-annotating-mouse-brains.html"><i class="fa fa-check"></i><b>9</b> Cross-annotating mouse brains</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#loading-the-data"><i class="fa fa-check"></i><b>9.1</b> Loading the data</a></li>
<li class="chapter" data-level="9.2" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#applying-the-annotation"><i class="fa fa-check"></i><b>9.2</b> Applying the annotation</a></li>
<li class="chapter" data-level="9.3" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#diagnostics"><i class="fa fa-check"></i><b>9.3</b> Diagnostics</a></li>
<li class="chapter" data-level="9.4" data-path="cross-annotating-human-pancreas.html"><a href="cross-annotating-human-pancreas.html#comparison-to-clusters"><i class="fa fa-check"></i><b>9.4</b> Comparison to clusters</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-information"><i class="fa fa-check"></i>Session information</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="10" data-path="contributors.html"><a href="contributors.html"><i class="fa fa-check"></i><b>10</b> Contributors</a>
<ul>
<li><a href="contributors.html#aaron-lun"><em>Aaron Lun</em></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i><b>11</b> Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://bioconductor.org" target="blank">Published by Bioconductor</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Assigning cell types with SingleR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="more-markers" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Controlling marker detection</h1>
<script>
document.addEventListener("click", function (event) {
    if (event.target.classList.contains("aaron-collapse")) {
        event.target.classList.toggle("active");
        var content = event.target.nextElementSibling;
        if (content.style.display === "block") {
            content.style.display = "none";
        } else {
            content.style.display = "block";
        }
    }
})
</script>
<style>
.aaron-collapse {
  background-color: #eee;
  color: #444;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 15px;
}

.aaron-content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
  background-color: #f1f1f1;
}
</style>
<div id="overview" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Overview</h2>
<p>One of the most important steps in <em><a href="https://bioconductor.org/packages/3.12/SingleR">SingleR</a></em> (beyond the choice of reference, of course)
is the derivation of the marker genes used in the score calculation.
We have already introduced the classic approach in the previous chapter,
but it is similarly straightforward to perform marker detection with conventional statistical tests.
In particular, we identify top-ranked markers based on pairwise Wilcoxon rank sum tests or <span class="math inline">\(t\)</span>-tests between labels;
this allows us to account for the variability across cells to choose genes that are robustly upregulated in each label.</p>
<p>The availability of variance-aware marker detection methods is most relevant for reference datasets
that contain a reasonable number (i.e., at least two) of replicate samples for each label.
An obvious use case is that of single-cell datasets that are used as a reference to annotate other single-cell datasets.
It is also possible for users to supply their own custom marker lists to <code>SingleR()</code>,
facilitating incorporation of prior biological knowledge into the annotation process.
We will demonstrate these capabilities below in this chapter.</p>
</div>
<div id="annotation-with-test-based-marker-detection" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Annotation with test-based marker detection</h2>
<p>To demonstrate, we will use two human pancreas scRNA-seq datasets from the <em><a href="https://bioconductor.org/packages/3.12/scRNAseq">scRNAseq</a></em> package.
The aim is to use one pre-labelled dataset to annotate the other unlabelled dataset.
First, we set up the <span class="citation">Muraro et al. (<a href="#ref-muraro2016singlecell" role="doc-biblioref">2016</a>)</span> dataset to be our reference,
computing log-normalized expression values as discussed in Section <a href="using-the-classic-mode.html#choices-of-assay-data">2.4</a>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="more-markers.html#cb19-1" aria-hidden="true"></a><span class="kw">library</span>(scRNAseq)</span>
<span id="cb19-2"><a href="more-markers.html#cb19-2" aria-hidden="true"></a>sceM &lt;-<span class="st"> </span><span class="kw">MuraroPancreasData</span>()</span>
<span id="cb19-3"><a href="more-markers.html#cb19-3" aria-hidden="true"></a></span>
<span id="cb19-4"><a href="more-markers.html#cb19-4" aria-hidden="true"></a><span class="co"># Removing unlabelled cells or cells without a clear label.</span></span>
<span id="cb19-5"><a href="more-markers.html#cb19-5" aria-hidden="true"></a>sceM &lt;-<span class="st"> </span>sceM[,<span class="op">!</span><span class="kw">is.na</span>(sceM<span class="op">$</span>label) <span class="op">&amp;</span><span class="st"> </span>sceM<span class="op">$</span>label<span class="op">!=</span><span class="st">&quot;unclear&quot;</span>] </span>
<span id="cb19-6"><a href="more-markers.html#cb19-6" aria-hidden="true"></a></span>
<span id="cb19-7"><a href="more-markers.html#cb19-7" aria-hidden="true"></a><span class="kw">library</span>(scater)</span>
<span id="cb19-8"><a href="more-markers.html#cb19-8" aria-hidden="true"></a>sceM &lt;-<span class="st"> </span><span class="kw">logNormCounts</span>(sceM)</span>
<span id="cb19-9"><a href="more-markers.html#cb19-9" aria-hidden="true"></a>sceM</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 19059 2122 
## metadata(0):
## assays(2): counts logcounts
## rownames(19059): A1BG-AS1__chr19 A1BG__chr19 ... ZZEF1__chr17
##   ZZZ3__chr1
## rowData names(2): symbol chr
## colnames(2122): D28-1_1 D28-1_2 ... D30-8_93 D30-8_94
## colData names(4): label donor plate sizeFactor
## reducedDimNames(0):
## altExpNames(1): ERCC</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="more-markers.html#cb21-1" aria-hidden="true"></a><span class="co"># Seeing the available labels in this dataset.</span></span>
<span id="cb21-2"><a href="more-markers.html#cb21-2" aria-hidden="true"></a><span class="kw">table</span>(sceM<span class="op">$</span>label)</span></code></pre></div>
<pre><code>## 
##      acinar       alpha        beta       delta        duct endothelial 
##         219         812         448         193         245          21 
##     epsilon mesenchymal          pp 
##           3          80         101</code></pre>
<p>We then set up our test dataset from <span class="citation">Grun et al. (<a href="#ref-grun2016denovo" role="doc-biblioref">2016</a>)</span>, applying some basic quality control as discusssed
<a href="https://osca.bioconductor.org/grun-human-pancreas-cel-seq2.html#quality-control-8">here</a>
and in Section <a href="using-the-classic-mode.html#interaction-with-quality-control">2.3</a>.
We also compute the log-transformed values here, not because it is strictly necessary
but so that we don’t have to keep on typing <code>assay.type.test=1</code> in later calls to <code>SingleR()</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="more-markers.html#cb23-1" aria-hidden="true"></a>sceG &lt;-<span class="st"> </span><span class="kw">GrunPancreasData</span>()</span>
<span id="cb23-2"><a href="more-markers.html#cb23-2" aria-hidden="true"></a></span>
<span id="cb23-3"><a href="more-markers.html#cb23-3" aria-hidden="true"></a>sceG &lt;-<span class="st"> </span><span class="kw">addPerCellQC</span>(sceG)</span>
<span id="cb23-4"><a href="more-markers.html#cb23-4" aria-hidden="true"></a>qc &lt;-<span class="st"> </span><span class="kw">quickPerCellQC</span>(<span class="kw">colData</span>(sceG), </span>
<span id="cb23-5"><a href="more-markers.html#cb23-5" aria-hidden="true"></a>    <span class="dt">percent_subsets=</span><span class="st">&quot;altexps_ERCC_percent&quot;</span>,</span>
<span id="cb23-6"><a href="more-markers.html#cb23-6" aria-hidden="true"></a>    <span class="dt">batch=</span>sceG<span class="op">$</span>donor,</span>
<span id="cb23-7"><a href="more-markers.html#cb23-7" aria-hidden="true"></a>    <span class="dt">subset=</span>sceG<span class="op">$</span>donor <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;D17&quot;</span>, <span class="st">&quot;D7&quot;</span>, <span class="st">&quot;D2&quot;</span>))</span>
<span id="cb23-8"><a href="more-markers.html#cb23-8" aria-hidden="true"></a>sceG &lt;-<span class="st"> </span>sceG[,<span class="op">!</span>qc<span class="op">$</span>discard]</span>
<span id="cb23-9"><a href="more-markers.html#cb23-9" aria-hidden="true"></a></span>
<span id="cb23-10"><a href="more-markers.html#cb23-10" aria-hidden="true"></a>sceG &lt;-<span class="st"> </span><span class="kw">logNormCounts</span>(sceG)</span>
<span id="cb23-11"><a href="more-markers.html#cb23-11" aria-hidden="true"></a>sceG</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 20064 1064 
## metadata(0):
## assays(2): counts logcounts
## rownames(20064): A1BG-AS1__chr19 A1BG__chr19 ... ZZEF1__chr17
##   ZZZ3__chr1
## rowData names(2): symbol chr
## colnames(1064): D2ex_1 D2ex_2 ... D17TGFB_94 D17TGFB_95
## colData names(9): donor sample ... total sizeFactor
## reducedDimNames(0):
## altExpNames(1): ERCC</code></pre>
<p>We run <code>SingleR()</code> as described previously but with a marker detection mode that considers the variance of expression across cells.
Here, we will use the Wilcoxon ranked sum test to identify the top markers for each pairwise comparison between labels.
This is slower but more appropriate for single-cell data compared to the default marker detection algorithm,
as the latter may fail for low-coverage data where the median for each label is often zero.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="more-markers.html#cb25-1" aria-hidden="true"></a><span class="kw">library</span>(SingleR)</span>
<span id="cb25-2"><a href="more-markers.html#cb25-2" aria-hidden="true"></a>pred.grun &lt;-<span class="st"> </span><span class="kw">SingleR</span>(<span class="dt">test=</span>sceG, <span class="dt">ref=</span>sceM, <span class="dt">labels=</span>sceM<span class="op">$</span>label, <span class="dt">de.method=</span><span class="st">&quot;wilcox&quot;</span>)</span>
<span id="cb25-3"><a href="more-markers.html#cb25-3" aria-hidden="true"></a><span class="kw">table</span>(pred.grun<span class="op">$</span>labels)</span></code></pre></div>
<pre><code>## 
##      acinar       alpha        beta       delta        duct endothelial 
##         277         203         181          50         306           5 
##     epsilon mesenchymal          pp 
##           1          22          19</code></pre>
<p>By default, the function will take the top <code>de.n</code> (default: 10) genes from each pairwise comparison between labels.
A larger number of markers increases the robustness of the annotation by ensuring that relevant genes are not omitted,
especially if the reference dataset has study-specific effects that cause uninteresting genes to dominate the top set.
However, this comes at the cost of increasing noise and computational time.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="more-markers.html#cb27-1" aria-hidden="true"></a><span class="kw">library</span>(SingleR)</span>
<span id="cb27-2"><a href="more-markers.html#cb27-2" aria-hidden="true"></a>pred.grun &lt;-<span class="st"> </span><span class="kw">SingleR</span>(<span class="dt">test=</span>sceG, <span class="dt">ref=</span>sceM, <span class="dt">labels=</span>sceM<span class="op">$</span>label, </span>
<span id="cb27-3"><a href="more-markers.html#cb27-3" aria-hidden="true"></a>    <span class="dt">de.method=</span><span class="st">&quot;wilcox&quot;</span>, <span class="dt">de.n=</span><span class="dv">50</span>)</span>
<span id="cb27-4"><a href="more-markers.html#cb27-4" aria-hidden="true"></a><span class="kw">table</span>(pred.grun<span class="op">$</span>labels)</span></code></pre></div>
<pre><code>## 
##      acinar       alpha        beta       delta        duct endothelial 
##         275         203         177          55         307           5 
##     epsilon mesenchymal          pp 
##           1          23          18</code></pre>
</div>
<div id="defining-custom-markers" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Defining custom markers</h2>
<p>The marker detection in <code>SingleR()</code> is built on top of the testing framework in <em><a href="https://bioconductor.org/packages/3.12/scran">scran</a></em>,
so most options in <code>?pairwiseWilcox</code> and friends can be applied via the <code>de.args=</code> option.
For example, we could use the <span class="math inline">\(t\)</span>-test and test against a log-fold change threshold with <code>de.args=list(lfc=1)</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="more-markers.html#cb29-1" aria-hidden="true"></a><span class="kw">library</span>(SingleR)</span>
<span id="cb29-2"><a href="more-markers.html#cb29-2" aria-hidden="true"></a>pred.grun2 &lt;-<span class="st"> </span><span class="kw">SingleR</span>(<span class="dt">test=</span>sceG, <span class="dt">ref=</span>sceM, <span class="dt">labels=</span>sceM<span class="op">$</span>label, </span>
<span id="cb29-3"><a href="more-markers.html#cb29-3" aria-hidden="true"></a>    <span class="dt">de.method=</span><span class="st">&quot;t&quot;</span>, <span class="dt">de.args=</span><span class="kw">list</span>(<span class="dt">lfc=</span><span class="dv">1</span>))</span>
<span id="cb29-4"><a href="more-markers.html#cb29-4" aria-hidden="true"></a><span class="kw">table</span>(pred.grun2<span class="op">$</span>labels)</span></code></pre></div>
<pre><code>## 
##      acinar       alpha        beta       delta        duct endothelial 
##         285         200         177          54         296           5 
##     epsilon mesenchymal          pp 
##           5          24          18</code></pre>
<p>However, users can also construct their own marker lists with any DE testing machinery.
For example, we can perform pairwise binomial tests to identify genes that are differentially detected
(i.e., have differences in the proportion of cells with non-zero counts) between labels in the reference Muraro dataset.
We then take the top 10 marker genes from each pairwise comparison,
obtaining a list of lists of character vectors containing the identities of the markers for that comparison.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="more-markers.html#cb31-1" aria-hidden="true"></a><span class="kw">library</span>(scran)</span>
<span id="cb31-2"><a href="more-markers.html#cb31-2" aria-hidden="true"></a>out &lt;-<span class="st"> </span><span class="kw">pairwiseBinom</span>(<span class="kw">counts</span>(sceM), sceM<span class="op">$</span>label, <span class="dt">direction=</span><span class="st">&quot;up&quot;</span>)</span>
<span id="cb31-3"><a href="more-markers.html#cb31-3" aria-hidden="true"></a>markers &lt;-<span class="st"> </span><span class="kw">getTopMarkers</span>(out<span class="op">$</span>statistics, out<span class="op">$</span>pairs, <span class="dt">n=</span><span class="dv">10</span>)</span>
<span id="cb31-4"><a href="more-markers.html#cb31-4" aria-hidden="true"></a></span>
<span id="cb31-5"><a href="more-markers.html#cb31-5" aria-hidden="true"></a><span class="co"># Upregulated in acinar compared to alpha:</span></span>
<span id="cb31-6"><a href="more-markers.html#cb31-6" aria-hidden="true"></a>markers<span class="op">$</span>acinar<span class="op">$</span>alpha</span></code></pre></div>
<pre><code>##  [1] &quot;KCNQ1__chr11&quot;  &quot;FAM129A__chr1&quot; &quot;KLK1__chr19&quot;   &quot;NTN4__chr12&quot;  
##  [5] &quot;RASEF__chr9&quot;   &quot;CTRL__chr16&quot;   &quot;LGALS2__chr22&quot; &quot;NUPR1__chr16&quot; 
##  [9] &quot;LGALS3__chr14&quot; &quot;NR5A2__chr1&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="more-markers.html#cb33-1" aria-hidden="true"></a><span class="co"># Upregulated in alpha compared to acinar:</span></span>
<span id="cb33-2"><a href="more-markers.html#cb33-2" aria-hidden="true"></a>markers<span class="op">$</span>alpha<span class="op">$</span>acinar</span></code></pre></div>
<pre><code>##  [1] &quot;SLC38A4__chr12&quot; &quot;ARX__chrX&quot;      &quot;CRYBA2__chr2&quot;   &quot;FSTL5__chr4&quot;   
##  [5] &quot;GNG2__chr14&quot;    &quot;NOL4__chr18&quot;    &quot;IRX2__chr5&quot;     &quot;KCNMB2__chr3&quot;  
##  [9] &quot;CFC1__chr2&quot;     &quot;KCNJ6__chr21&quot;</code></pre>
<p>Once we have this list of lists, we supply it to <code>SingleR()</code> via the <code>genes=</code> argument,
which causes the function to bypass the internal marker detection to use the supplied gene sets instead.
The most obvious benefit of this approach is that the user can achieve greater control of the markers,
allowing integration of prior biological knowledge to obtain more relevant genes and a more robust annotation.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="more-markers.html#cb35-1" aria-hidden="true"></a>pred.grun2b &lt;-<span class="st"> </span><span class="kw">SingleR</span>(<span class="dt">test=</span>sceG, <span class="dt">ref=</span>sceM, <span class="dt">labels=</span>sceM<span class="op">$</span>label, <span class="dt">genes=</span>markers)</span>
<span id="cb35-2"><a href="more-markers.html#cb35-2" aria-hidden="true"></a><span class="kw">table</span>(pred.grun2b<span class="op">$</span>labels)</span></code></pre></div>
<pre><code>## 
##      acinar       alpha        beta       delta        duct endothelial 
##         276         202         175          54         302           5 
##     epsilon mesenchymal          pp 
##           2          25          23</code></pre>
<p>In some cases, markers may only be available for specific labels rather than for pairwise comparisons between labels.
This is accommodated by supplying a named list of character vectors to <code>genes</code>.
Note that this is likely to be less powerful than the list-of-lists approach as information about pairwise differences is discarded.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="more-markers.html#cb37-1" aria-hidden="true"></a><span class="co"># Creating label-specific markers.</span></span>
<span id="cb37-2"><a href="more-markers.html#cb37-2" aria-hidden="true"></a>label.markers &lt;-<span class="st"> </span><span class="kw">lapply</span>(markers, unlist)</span>
<span id="cb37-3"><a href="more-markers.html#cb37-3" aria-hidden="true"></a>label.markers &lt;-<span class="st"> </span><span class="kw">lapply</span>(label.markers, unique)</span>
<span id="cb37-4"><a href="more-markers.html#cb37-4" aria-hidden="true"></a><span class="kw">str</span>(label.markers)</span></code></pre></div>
<pre><code>## List of 9
##  $ acinar     : chr [1:40] &quot;KCNQ1__chr11&quot; &quot;FAM129A__chr1&quot; &quot;KLK1__chr19&quot; &quot;NTN4__chr12&quot; ...
##  $ alpha      : chr [1:41] &quot;SLC38A4__chr12&quot; &quot;ARX__chrX&quot; &quot;CRYBA2__chr2&quot; &quot;FSTL5__chr4&quot; ...
##  $ beta       : chr [1:47] &quot;ELAVL4__chr1&quot; &quot;PRUNE2__chr9&quot; &quot;NMNAT2__chr1&quot; &quot;PLCB4__chr20&quot; ...
##  $ delta      : chr [1:44] &quot;NOL4__chr18&quot; &quot;CABP7__chr22&quot; &quot;UNC80__chr2&quot; &quot;HEPACAM2__chr7&quot; ...
##  $ duct       : chr [1:50] &quot;ADCY5__chr3&quot; &quot;PDE3A__chr12&quot; &quot;SLC3A1__chr2&quot; &quot;BICC1__chr10&quot; ...
##  $ endothelial: chr [1:26] &quot;GPR4__chr19&quot; &quot;TMEM204__chr16&quot; &quot;GPR116__chr6&quot; &quot;CYYR1__chr21&quot; ...
##  $ epsilon    : chr [1:14] &quot;BHMT__chr5&quot; &quot;JPH3__chr16&quot; &quot;SERPINA10__chr14&quot; &quot;UGT2B4__chr4&quot; ...
##  $ mesenchymal: chr [1:34] &quot;TNFAIP6__chr2&quot; &quot;THBS2__chr6&quot; &quot;CDH11__chr16&quot; &quot;SRPX2__chrX&quot; ...
##  $ pp         : chr [1:44] &quot;SERTM1__chr13&quot; &quot;ETV1__chr7&quot; &quot;ARX__chrX&quot; &quot;ELAVL4__chr1&quot; ...</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="more-markers.html#cb39-1" aria-hidden="true"></a>pred.grun2c &lt;-<span class="st"> </span><span class="kw">SingleR</span>(<span class="dt">test=</span>sceG, <span class="dt">ref=</span>sceM, <span class="dt">labels=</span>sceM<span class="op">$</span>label, <span class="dt">genes=</span>label.markers)</span>
<span id="cb39-2"><a href="more-markers.html#cb39-2" aria-hidden="true"></a><span class="kw">table</span>(pred.grun2c<span class="op">$</span>labels)</span></code></pre></div>
<pre><code>## 
##      acinar       alpha        beta       delta        duct endothelial 
##         262         204         169          59         317           6 
##     epsilon mesenchymal          pp 
##           2          24          21</code></pre>
</div>
<div id="pseudo-bulk-aggregation" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Pseudo-bulk aggregation</h2>
<p>Single-cell reference datasets provide a like-for-like comparison to our test single-cell datasets,
yielding a more accurate classification of the cells in the latter (hopefully).
However, there are frequently many more samples in single-cell references compared to bulk references,
increasing the computational work involved in classification.
We overcome this by aggregating cells into one “pseudo-bulk” sample per label (e.g., by averaging across log-expression values)
and using that as the reference profile, which allows us to achieve the same efficiency as the use of bulk references.</p>
<p>The obvious cost of this approach is that we discard potentially useful information
about the distribution of cells within each label.
Cells that belong to a heterogeneous population may not be correctly assigned if they are far from the population center.
To preserve some of this information, we perform <span class="math inline">\(k\)</span>-means clustering within each label
to create pseudo-bulk samples that are representative of a particular region of the expression space (i.e., vector quantization).
We create <span class="math inline">\(\sqrt{N}\)</span> clusters given a label with <span class="math inline">\(N\)</span> cells,
which provides a reasonable compromise between reducing computational work and preserving the label’s internal distribution.</p>
<p>To enable this aggregation, we simply set <code>aggr.ref=TRUE</code> in the <code>SingleR()</code> call.
This uses the <code>aggregateReference()</code> function to perform <span class="math inline">\(k\)</span>-means clustering <em>within</em> each label
(typically after principal components analysis on the log-expression matrix, for greater speed)
and average expression values for each within-label cluster.
Note that marker detection is still performed on the unaggregated data
so as to make full use of the distribution of expression values across cells.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="more-markers.html#cb41-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">100</span>) <span class="co"># for the k-means step.</span></span>
<span id="cb41-2"><a href="more-markers.html#cb41-2" aria-hidden="true"></a>pred.grun3 &lt;-<span class="st"> </span><span class="kw">SingleR</span>(<span class="dt">test=</span>sceG, <span class="dt">ref=</span>sceM, <span class="dt">labels=</span>sceM<span class="op">$</span>label, </span>
<span id="cb41-3"><a href="more-markers.html#cb41-3" aria-hidden="true"></a>    <span class="dt">de.method=</span><span class="st">&quot;wilcox&quot;</span>, <span class="dt">aggr.ref=</span><span class="ot">TRUE</span>)</span>
<span id="cb41-4"><a href="more-markers.html#cb41-4" aria-hidden="true"></a><span class="kw">table</span>(pred.grun3<span class="op">$</span>labels)</span></code></pre></div>
<pre><code>## 
##      acinar       alpha        beta       delta        duct endothelial 
##         277         202         184          47         306           5 
##     epsilon mesenchymal          pp 
##           1          22          20</code></pre>
<p>Obviously, the aggregation itself requires computational work so setting <code>aggr.ref=TRUE</code> in <code>SingleR()</code> itself may not improve speed.
Rather, the real power of this approach lies in pre-aggregating the reference dataset
so that it can be repeatedly applied to quickly annotate multiple test datasets.
This approach is discussed in more detail in Chapter <a href="advanced-options.html#advanced-options">7</a>.</p>
</div>
<div id="session-information" class="section level2 unnumbered">
<h2>Session information</h2>
<button class="aaron-collapse">
View session info
</button>
<div class="aaron-content">
<pre><code>R version 4.0.0 Patched (2020-05-01 r78341)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.4 LTS

Matrix products: default
BLAS:   /home/luna/Software/R/R-4-0-branch-dev/lib/libRblas.so
LAPACK: /home/luna/Software/R/R-4-0-branch-dev/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] scran_1.17.4                SingleR_1.3.6              
 [3] scater_1.17.3               ggplot2_3.3.2              
 [5] scRNAseq_2.3.6              SingleCellExperiment_1.11.6
 [7] SummarizedExperiment_1.19.5 DelayedArray_0.15.6        
 [9] matrixStats_0.56.0          Matrix_1.2-18              
[11] Biobase_2.49.0              GenomicRanges_1.41.5       
[13] GenomeInfoDb_1.25.5         IRanges_2.23.10            
[15] S4Vectors_0.27.12           BiocGenerics_0.35.4        
[17] BiocStyle_2.17.0            rebook_0.99.0              

loaded via a namespace (and not attached):
 [1] bitops_1.0-6                  bit64_0.9-7                  
 [3] httr_1.4.1                    tools_4.0.0                  
 [5] R6_2.4.1                      irlba_2.3.3                  
 [7] vipor_0.4.5                   DBI_1.1.0                    
 [9] colorspace_1.4-1              withr_2.2.0                  
[11] gridExtra_2.3                 tidyselect_1.1.0             
[13] processx_3.4.2                bit_1.1-15.2                 
[15] curl_4.3                      compiler_4.0.0               
[17] graph_1.67.1                  BiocNeighbors_1.7.0          
[19] bookdown_0.20                 scales_1.1.1                 
[21] callr_3.4.3                   rappdirs_0.3.1               
[23] stringr_1.4.0                 digest_0.6.25                
[25] rmarkdown_2.3                 XVector_0.29.3               
[27] pkgconfig_2.0.3               htmltools_0.5.0              
[29] limma_3.45.7                  dbplyr_1.4.4                 
[31] fastmap_1.0.1                 rlang_0.4.6                  
[33] RSQLite_2.2.0                 shiny_1.5.0                  
[35] DelayedMatrixStats_1.11.1     generics_0.0.2               
[37] BiocParallel_1.23.0           dplyr_1.0.0                  
[39] RCurl_1.98-1.2                magrittr_1.5                 
[41] BiocSingular_1.5.0            GenomeInfoDbData_1.2.3       
[43] scuttle_0.99.10               Rcpp_1.0.4.6                 
[45] ggbeeswarm_0.6.0              munsell_0.5.0                
[47] viridis_0.5.1                 lifecycle_0.2.0              
[49] edgeR_3.31.4                  stringi_1.4.6                
[51] yaml_2.2.1                    zlibbioc_1.35.0              
[53] BiocFileCache_1.13.0          AnnotationHub_2.21.1         
[55] grid_4.0.0                    blob_1.2.1                   
[57] dqrng_0.2.1                   promises_1.1.1               
[59] ExperimentHub_1.15.0          crayon_1.3.4                 
[61] lattice_0.20-41               locfit_1.5-9.4               
[63] CodeDepends_0.6.5             knitr_1.29                   
[65] ps_1.3.3                      pillar_1.4.4                 
[67] igraph_1.2.5                  codetools_0.2-16             
[69] XML_3.99-0.3                  glue_1.4.1                   
[71] BiocVersion_3.12.0            evaluate_0.14                
[73] BiocManager_1.30.10           vctrs_0.3.1                  
[75] httpuv_1.5.4                  gtable_0.3.0                 
[77] purrr_0.3.4                   assertthat_0.2.1             
[79] xfun_0.15                     rsvd_1.0.3                   
[81] mime_0.9                      xtable_1.8-4                 
[83] later_1.1.0.1                 viridisLite_0.3.0            
[85] tibble_3.0.1                  AnnotationDbi_1.51.1         
[87] beeswarm_0.2.3                memoise_1.1.0                
[89] statmod_1.4.34                ellipsis_0.3.1               
[91] interactiveDisplayBase_1.27.5</code></pre>
</div>

</div>
</div>
<h3> Bibliography</h3>
<div id="refs" class="references">
<div id="ref-grun2016denovo">
<p>Grun, D., M. J. Muraro, J. C. Boisset, K. Wiebrands, A. Lyubimova, G. Dharmadhikari, M. van den Born, et al. 2016. “De Novo Prediction of Stem Cell Identity using Single-Cell Transcriptome Data.” <em>Cell Stem Cell</em> 19 (2): 266–77.</p>
</div>
<div id="ref-muraro2016singlecell">
<p>Muraro, M. J., G. Dharmadhikari, D. Grun, N. Groen, T. Dielen, E. Jansen, L. van Gurp, et al. 2016. “A Single-Cell Transcriptome Atlas of the Human Pancreas.” <em>Cell Syst</em> 3 (4): 385–94.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using-the-classic-mode.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="annotation-diagnostics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/LTLA/SingleRBook-base/edit/master/scref.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/LTLA/SingleRBook-base/commits/master/scref.Rmd",
"text": null
},
"view": {
"link": "https://github.com/LTLA/SingleRBook-base/blob/master/scref.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"bookdown::epub_book": "default",
"description": "The SingleR book. Because sometimes, a vignette just isn't enough.",
"cover-image": "https://raw.githubusercontent.com/Bioconductor/BiocStickers/master/SingleR/SingleR_sticker_invert.png",
"favicon": "https://bioc2019.bioconductor.org/images/favicon.ico"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
